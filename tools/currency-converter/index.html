 <!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>محول العملات الفوري — تحويل USD إلى SAR و EUR و TRY | MarketAPro</title>
  <meta name="description" content="محول عملات عربي مجاني: تحويل فوري بين العملات مع سعر الصرف وتاريخ التحديث وسجل آخر التحويلات. العملة الافتراضية USD." />
  <meta name="keywords" content="محول العملات, تحويل العملات, USD SAR, سعر الصرف, currency converter, تحويل دولار ريال, تحويل دولار ليرة" />
  <link rel="canonical" href="https://marketapro.com/tools/currency-converter/" />

  <!-- Open Graph -->
  <meta property="og:title" content="محول العملات الفوري — MarketAPro" />
  <meta property="og:description" content="تحويل فوري بين العملات + سعر الصرف + تاريخ التحديث — بدون تسجيل." />
  <meta property="og:url" content="https://marketapro.com/tools/currency-converter/" />
  <meta property="og:type" content="website" />

  <meta name="twitter:card" content="summary_large_image" />

  <link rel="stylesheet" href="/style.css" />

  <!-- Breadcrumb -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"الرئيسية","item":"https://marketapro.com/"},
      {"@type":"ListItem","position":2,"name":"الأدوات","item":"https://marketapro.com/tools/"},
      {"@type":"ListItem","position":3,"name":"محول العملات","item":"https://marketapro.com/tools/currency-converter/"}
    ]
  }
  </script>

  <!-- WebApplication -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebApplication",
    "name":"محول العملات الفوري",
    "url":"https://marketapro.com/tools/currency-converter/",
    "applicationCategory":"FinanceApplication",
    "operatingSystem":"Any",
    "description":"محول عملات عربي مجاني: تحويل فوري بين العملات مع سعر الصرف وتاريخ التحديث وسجل آخر التحويلات.",
    "offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},
    "publisher":{"@type":"Organization","name":"MarketAPro","url":"https://marketapro.com/"}
  }
  </script>

  <!-- FAQ Schema -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {
        "@type":"Question",
        "name":"هل محول العملات مجاني وبدون تسجيل؟",
        "acceptedAnswer":{"@type":"Answer","text":"نعم. الأداة مجانية تمامًا ولا تحتاج تسجيل."}
      },
      {
        "@type":"Question",
        "name":"من أين تأتي أسعار الصرف؟",
        "acceptedAnswer":{"@type":"Answer","text":"يتم جلب أسعار الصرف عبر مزود خارجي (open.er-api.com) ثم يتم تخزينها مؤقتًا لتسريع الأداء."}
      },
      {
        "@type":"Question",
        "name":"كل كم يتم تحديث السعر؟",
        "acceptedAnswer":{"@type":"Answer","text":"حسب تحديث مزود البيانات. داخل الأداة يتم استخدام كاش لمدة 6 ساعات لتسريع التحويل."}
      }
    ]
  }
  </script>

  <style>
    /* محلي وخفيف — يعتمد على متغيرات style.css */
    .hero-block{
      padding:18px;border-radius:18px;border:1px solid var(--border);
      background:rgba(255,255,255,.02);
    }
    .hero-title{margin:0 0 8px;font-size:28px;line-height:1.4}
    .hero-desc{margin:0;color:var(--muted);line-height:1.9}
    .crumbs{margin-top:10px}

    .wrap{display:grid;grid-template-columns:1.05fr .95fr;gap:14px;margin-top:14px}
    @media (max-width: 900px){.wrap{grid-template-columns:1fr}}

    .card2{
      border:1px solid var(--border);
      border-radius:18px;
      background:rgba(0,0,0,.18);
      padding:14px;
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media(max-width:520px){.row{grid-template-columns:1fr}}
    label{display:block;color:var(--muted);font-size:13px;margin-bottom:6px}
    input, select{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      color:var(--text);
      outline:none;
    }
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{cursor:pointer}
    .btn.secondary{background:rgba(255,255,255,.02)}

    .quick{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .chip{
      padding:8px 10px;border-radius:999px;border:1px solid var(--border);
      background:rgba(255,255,255,.02);font-size:13px;font-weight:900;
      cursor:pointer; user-select:none; opacity:.9;
    }
    .chip:hover{opacity:1}

    .stat-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
    @media(max-width:520px){.stat-grid{grid-template-columns:1fr}}
    .stat{
      padding:14px;border-radius:16px;background:rgba(0,0,0,.18);
      border:1px solid var(--border);
    }
    .stat strong{display:block;font-size:18px}
    .stat span{color:var(--muted);font-size:13px}

    .list{margin:10px 0 0;padding-right:18px;color:var(--muted);line-height:1.9}
    .divider{height:1px;background:var(--border);margin:14px 0}

    .toast{
      position:fixed;inset-inline-start:16px;bottom:16px;
      background:rgba(0,0,0,.65);border:1px solid var(--border);
      border-radius:14px;padding:10px 12px;color:var(--text);
      display:none;max-width: 340px;z-index: 9999;
    }
    .warn{
      border:1px solid rgba(250,204,21,.35);
      background:rgba(250,204,21,.08);
      color:#ffe9a6;
      padding:10px 12px;border-radius:14px;font-weight:900;font-size:13px;
      display:none;margin-top:10px;white-space:pre-wrap
    }
    .muted{color:var(--muted)}
  </style>
</head>

<body>
<a class="skip-link" href="#content">تخطي إلى المحتوى</a>

<header class="header">
  <div class="container header-inner">
    <a class="brand" href="/" aria-label="العودة للرئيسية">
      <div class="brand-badge" aria-hidden="true"></div>
      <div>
        <p class="brand-title">MarketAPro</p>
        <p class="brand-sub">محول العملات</p>
      </div>
    </a>
    <nav class="nav" aria-label="القائمة الرئيسية">
      <a href="/">الرئيسية</a>
      <a class="active" href="/tools/">الأدوات</a>
      <a href="/news/">المقالات</a>
      <a href="https://vivamediacreative.com/ar/" rel="noopener">Viva Media Creative</a>
    </nav>
  </div>
</header>

<main id="content" class="container section">

  <section class="hero-block">
    <h1 class="hero-title">محول العملات الفوري</h1>

    <nav aria-label="Breadcrumb" class="note crumbs">
      <a href="/">الرئيسية</a> ←
      <a href="/tools/">الأدوات</a> ←
      <span>محول العملات</span>
    </nav>

    <p class="hero-desc">
      تحويل فوري بين العملات مع <strong>سعر الصرف</strong> و<strong>تاريخ التحديث</strong> + حفظ آخر التحويلات.
      العملة الافتراضية: <strong>USD</strong>.
    </p>

    <div class="quick" aria-label="تحويلات سريعة">
      <span class="chip" data-pair="USD,SAR">USD → SAR</span>
      <span class="chip" data-pair="USD,TRY">USD → TRY</span>
      <span class="chip" data-pair="USD,EGP">USD → EGP</span>
      <span class="chip" data-pair="USD,EUR">USD → EUR</span>
      <span class="chip" data-pair="EUR,USD">EUR → USD</span>
    </div>
  </section>

  <section class="wrap">

    <!-- Inputs -->
    <section class="card2" aria-label="مدخلات التحويل">
      <div class="row">
        <div>
          <label for="amount">المبلغ</label>
          <input id="amount" type="number" inputmode="decimal" min="0" step="0.01" value="1" />
        </div>

        <div>
          <label for="base">العملة الأساسية (From)</label>
          <input id="base" list="currencyList" placeholder="اكتب أو اختر (مثال: USD)" value="USD" autocomplete="off">
        </div>

        <div>
          <label for="target">العملة المستهدفة (To)</label>
          <input id="target" list="currencyList" placeholder="اكتب أو اختر (مثال: SAR)" value="SAR" autocomplete="off">
        </div>

        <div>
          <label>&nbsp;</label>
          <button class="btn primary" id="convertBtn" type="button">تحويل الآن</button>
        </div>
      </div>

      <datalist id="currencyList"></datalist>

      <div class="actions">
        <button class="btn secondary" id="swapBtn" type="button">تبديل العملات</button>
        <button class="btn secondary" id="copyBtn" type="button">نسخ النتيجة</button>
        <button class="btn secondary" id="clearHistoryBtn" type="button">مسح السجل</button>
      </div>

      <div class="warn" id="warnBox"></div>

      <p class="muted" style="margin:10px 0 0;font-size:13px;line-height:1.9">
        ملاحظة: الأسعار تأتي من مزود خارجي، ويتم تخزينها مؤقتًا (كاش) لتسريع الأداء.
      </p>
    </section>

    <!-- Output -->
    <section class="card2" aria-label="نتائج التحويل">
      <h2 style="margin:0 0 6px;font-size:18px">النتيجة</h2>

      <div class="stat-grid" aria-label="ملخص النتيجة">
        <div class="stat">
          <strong id="result">—</strong>
          <span>المبلغ بعد التحويل</span>
        </div>
        <div class="stat">
          <strong id="rate">—</strong>
          <span>سعر الصرف</span>
        </div>
      </div>

      <div class="divider"></div>

      <p class="muted" id="updated" style="margin:0;font-size:13px">آخر تحديث: —</p>

      <div class="divider"></div>

      <h3 style="margin:0 0 6px;font-size:16px">آخر 5 تحويلات</h3>
      <ul class="list" id="historyList"></ul>

      <div class="divider"></div>

      <div class="card" style="background:rgba(255,255,255,.02);border:1px solid var(--border);box-shadow:none">
        <h3 style="margin:0 0 6px;font-size:16px">روابط داخلية مفيدة</h3>
        <ul class="list" style="margin-top:8px">
          <li><a href="/tools/">كل الأدوات المجانية</a></li>
          <li><a href="/tools/instagram-engagement-calculator/">حاسبة معدل التفاعل على إنستغرام</a></li>
          <li><a href="/tools/instagram-profile-analyzer/">تحليل حساب إنستغرام</a></li>
        </ul>
      </div>
    </section>

  </section>

  <section class="card2" style="margin-top:14px" aria-label="أسئلة شائعة">
    <h2 style="margin:0 0 10px;font-size:18px">أسئلة شائعة</h2>
    <details>
      <summary style="cursor:pointer;font-weight:900">هل الأسعار فورية تمامًا؟</summary>
      <p class="muted" style="margin:10px 0 0;line-height:1.9">
        الأسعار تأتي من مزود خارجي. داخل الأداة نستخدم كاش لمدة 6 ساعات لتسريع الأداء وتقليل الطلبات.
      </p>
    </details>
    <details>
      <summary style="cursor:pointer;font-weight:900">لماذا أحيانًا لا يعمل التحويل؟</summary>
      <p class="muted" style="margin:10px 0 0;line-height:1.9">
        غالبًا بسبب منع الاتصال من سياسة الأمان (CSP) أو انقطاع المزود. إذا عندك CSP، اسمح بالاتصال إلى open.er-api.com داخل connect-src.
      </p>
    </details>
  </section>

  <section class="cta" aria-label="خدمة العملاء">
    <div>
      <strong>تريد أدوات أكثر للتجارة والعمل الحر؟</strong>
      <span>تابع أدوات التحليل + أدوات التحويل — قادمة بشكل أقوى.</span>
    </div>
    <a class="btn primary"
       href="https://wa.me/491234567890?text=مرحبًا%20MarketAPro%2C%20أريد%20اقتراح%20أدوات%20جديدة"
       target="_blank" rel="noopener">
      واتساب
    </a>
  </section>

</main>

<div class="toast" id="toast" role="status" aria-live="polite"></div>

<footer class="footer">
  <div class="container">
    <div>© 2025 MarketAPro — Free Marketing Tools</div>
    <div style="margin-top:6px">By <a href="https://vivamediacreative.com/ar/" rel="noopener">Viva Media Creative</a></div>
  </div>
</footer>

<script>
(() => {
  "use strict";

  // ===== UI helpers =====
  const $ = (id) => document.getElementById(id);
  const toastEl = $("toast");
  const warnBox = $("warnBox");

  function showToast(msg){
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(window.__toastTimer);
    window.__toastTimer = setTimeout(() => toastEl.style.display = "none", 1800);
  }
  function showWarn(msg){
    warnBox.style.display = "block";
    warnBox.textContent = msg;
  }
  function clearWarn(){
    warnBox.style.display = "none";
    warnBox.textContent = "";
  }

  function safeUpper(v){ return String(v||"").trim().toUpperCase(); }
  function round2(n){ return Math.round((+n||0)*100)/100; }

  // ===== Cache =====
  const CACHE_TTL_MS = 6 * 60 * 60 * 1000; // 6 hours
  const cacheKey = (base) => `fx_rates_${base}`;
  const historyKey = "fx_history_last5";

  // ===== API (single provider: open.er-api.com) =====
  async function fetchRates(base){
    const url = `https://open.er-api.com/v6/latest/${encodeURIComponent(base)}`;
    const res = await fetch(url, { cache: "no-store" });
    if(!res.ok) throw new Error("فشل الاتصال بمزود الأسعار.");
    const data = await res.json();
    // expected: { result:"success", base_code:"USD", rates:{...}, time_last_update_utc:"..." }
    if(data.result !== "success" || !data.rates) throw new Error("بيانات الأسعار غير صالحة.");
    return data;
  }

  function readCache(base){
    try{
      const raw = localStorage.getItem(cacheKey(base));
      if(!raw) return null;
      const obj = JSON.parse(raw);
      if(!obj || !obj.ts || !obj.data) return null;
      if(Date.now() - obj.ts > CACHE_TTL_MS) return null;
      return obj.data;
    }catch(e){ return null; }
  }
  function writeCache(base, data){
    try{
      localStorage.setItem(cacheKey(base), JSON.stringify({ ts: Date.now(), data }));
    }catch(e){}
  }

  async function getRates(base){
    const cached = readCache(base);
    if(cached) return { data: cached, cached: true };
    const fresh = await fetchRates(base);
    writeCache(base, fresh);
    return { data: fresh, cached: false };
  }

  // ===== Currency list =====
  async function ensureCurrencyList(){
    // load from USD once (fast) to populate currencies
    const { data } = await getRates("USD");
    const codes = Object.keys(data.rates || {}).sort();
    const dl = $("currencyList");
    dl.innerHTML = codes.map(c => `<option value="${c}"></option>`).join("");
  }

  // ===== History =====
  function readHistory(){
    try{
      const raw = localStorage.getItem(historyKey);
      const arr = raw ? JSON.parse(raw) : [];
      return Array.isArray(arr) ? arr : [];
    }catch(e){ return []; }
  }
  function writeHistory(arr){
    try{ localStorage.setItem(historyKey, JSON.stringify(arr.slice(0,5))); }catch(e){}
  }
  function pushHistory(item){
    const arr = readHistory();
    const next = [item, ...arr].filter((x, i, self) => {
      // remove exact duplicates (same string)
      return self.findIndex(y => y.text === x.text) === i;
    });
    writeHistory(next.slice(0,5));
    renderHistory();
  }
  function renderHistory(){
    const ul = $("historyList");
    const arr = readHistory();
    ul.innerHTML = "";
    if(!arr.length){
      const li = document.createElement("li");
      li.textContent = "لا يوجد تحويلات محفوظة بعد.";
      ul.appendChild(li);
      return;
    }
    arr.forEach(h => {
      const li = document.createElement("li");
      li.textContent = h.text;
      ul.appendChild(li);
    });
  }

  // ===== Convert =====
  async function convert(){
    clearWarn();

    const amount = Number($("amount").value);
    const base = safeUpper($("base").value);
    const target = safeUpper($("target").value);

    if(!amount || amount <= 0){
      showWarn("أدخل مبلغًا صحيحًا أكبر من صفر.");
      return;
    }
    if(!/^[A-Z]{3}$/.test(base) || !/^[A-Z]{3}$/.test(target)){
      showWarn("اكتب رمز عملة صحيح من 3 أحرف (مثال: USD / SAR / EUR).");
      return;
    }

    $("base").value = base;
    $("target").value = target;

    $("result").textContent = "جارٍ التحويل…";
    $("rate").textContent = "—";
    $("updated").textContent = "آخر تحديث: —";

    try{
      const { data, cached } = await getRates(base);
      const r = data.rates?.[target];
      if(!r){
        showWarn(`العملة المستهدفة غير متاحة: ${target}. جرّب عملة أخرى.`);
        $("result").textContent = "—";
        return;
      }

      const converted = amount * Number(r);
      $("result").textContent = `${round2(converted).toLocaleString("ar")} ${target}`;
      $("rate").textContent = `1 ${base} = ${Number(r).toFixed(6)} ${target}`;
      $("updated").textContent = `آخر تحديث: ${data.time_last_update_utc || "—"}${cached ? " (من الكاش)" : ""}`;

      const line = `${amount} ${base} → ${round2(converted)} ${target}`;
      pushHistory({ text: line, ts: Date.now() });

      showToast("تم التحويل ✅");
    }catch(err){
      showWarn(
        "حدث خطأ أثناء جلب الأسعار.\n" +
        "إذا عندك CSP في الموقع: اسمح بالاتصال إلى open.er-api.com داخل connect-src.\n" +
        "تفاصيل: " + (err?.message || err)
      );
      $("result").textContent = "—";
    }
  }

  // ===== Actions =====
  $("convertBtn").addEventListener("click", convert);

  $("swapBtn").addEventListener("click", () => {
    const a = $("base").value;
    $("base").value = $("target").value;
    $("target").value = a;
    convert();
  });

  $("copyBtn").addEventListener("click", async () => {
    const base = safeUpper($("base").value);
    const target = safeUpper($("target").value);
    const amount = $("amount").value;
    const result = $("result").textContent;

    const txt =
`MarketAPro — محول العملات
المبلغ: ${amount}
من: ${base}
إلى: ${target}
النتيجة: ${result}
الرابط: https://marketapro.com/tools/currency-converter/`;

    try{
      await navigator.clipboard.writeText(txt);
      showToast("تم النسخ ✅");
    }catch(e){
      alert("تعذر النسخ تلقائيًا. انسخ يدويًا:\n\n" + txt);
    }
  });

  $("clearHistoryBtn").addEventListener("click", () => {
    localStorage.removeItem(historyKey);
    renderHistory();
    showToast("تم مسح السجل");
  });

  // Quick pairs
  document.querySelectorAll("[data-pair]").forEach(chip => {
    chip.addEventListener("click", () => {
      const [b,t] = String(chip.getAttribute("data-pair")||"").split(",");
      if(b && t){
        $("base").value = b;
        $("target").value = t;
        convert();
      }
    });
  });

  // Auto convert on changes (خفيف)
  ["amount","base","target"].forEach(id => {
    $(id).addEventListener("change", () => convert());
  });

  // Init
  (async () => {
    try{
      await ensureCurrencyList();
      renderHistory();
      convert();
    }catch(e){
      // if symbols load fails, still keep UI usable
      renderHistory();
      showWarn("تعذر تحميل قائمة العملات تلقائيًا. يمكنك كتابة رمز العملة يدويًا (USD / EUR / SAR ...).");
    }
  })();
})();
</script>
</body>
</html>

